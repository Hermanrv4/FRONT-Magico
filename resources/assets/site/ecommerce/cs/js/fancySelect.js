/* base/js/fancySelect.js */
(function(){var e;(e=window.jQuery||window.Zepto||window.$).fn.fancySelect=function(n){var t,s;return null==n&&(n={}),s=e.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(e){return e.text()},triggerTemplate:function(e){return e.text()}},n),t=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var n,r,i,a,o,l,f;if(!(a=e(this)).hasClass("fancified")&&"SELECT"===a[0].tagName)return a.addClass("fancified"),a.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),a.wrap('<div class="fancy-select">'),f=a.parent(),a.data("class")&&f.addClass(a.data("class")),f.append('<div class="trigger">'),t&&!s.forceiOS||f.append('<ul class="options">'),o=f.find(".trigger"),i=f.find(".options"),(r=a.prop("disabled"))&&f.addClass("disabled"),l=function(){var e;return e=s.triggerTemplate(a.find(":selected")),o.html(e)},a.on("blur.fs",function(){if(o.hasClass("open"))return setTimeout(function(){return o.trigger("close.fs")},120)}),o.on("close.fs",function(){return o.removeClass("open"),i.removeClass("open")}),o.on("click.fs",function(){var n;if(!r)if(o.toggleClass("open"),t&&!s.forceiOS){if(o.hasClass("open"))return a.focus()}else if(o.hasClass("open")&&((n=o.parent()).offsetParent(),n.offset().top+n.outerHeight()+i.outerHeight()+20>e(window).height()+e(window).scrollTop()?i.addClass("overflowing"):i.removeClass("overflowing")),i.toggleClass("open"),!t)return a.focus()}),a.on("enable",function(){return a.prop("disabled",!1),f.removeClass("disabled"),r=!1,n()}),a.on("disable",function(){return a.prop("disabled",!0),f.addClass("disabled"),r=!0}),a.on("change.fs",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():l()}),a.on("keydown",function(e){var n,t,s;if(s=e.which,(n=i.find(".hover")).removeClass("hover"),i.hasClass("open")){if(38===s?(e.preventDefault(),n.length&&n.index()>0?n.prev().addClass("hover"):i.find("li:last-child").addClass("hover")):40===s?(e.preventDefault(),n.length&&n.index()<i.find("li").length-1?n.next().addClass("hover"):i.find("li:first-child").addClass("hover")):27===s?(e.preventDefault(),o.trigger("click.fs")):13===s||32===s?(e.preventDefault(),n.trigger("click.fs")):9===s&&o.hasClass("open")&&o.trigger("close.fs"),(t=i.find(".hover")).length)return i.scrollTop(0),i.scrollTop(t.position().top-12)}else if(13===s||32===s||38===s||40===s)return e.preventDefault(),o.trigger("click.fs")}),i.on("click.fs","li",function(n){var s;return s=e(this),a.val(s.data("raw-value")),t||a.trigger("blur.fs").trigger("focus.fs"),i.find(".selected").removeClass("selected"),s.addClass("selected"),a.val(s.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),i.on("mouseenter.fs","li",function(){var n;return n=e(this),i.find(".hover").removeClass("hover"),n.addClass("hover")}),i.on("mouseleave.fs","li",function(){return i.find(".hover").removeClass("hover")}),n=function(){if(l(),!t||s.forceiOS)return a.find("option"),a.find("option").each(function(n,t){var r;if(!(t=e(t)).prop("disabled")&&(t.val()||s.includeBlank))return r=s.optionTemplate(t),t.prop("selected")?i.append('<li data-raw-value="'+t.val()+'" class="selected">'+r+"</li>"):i.append('<li data-raw-value="'+t.val()+'">'+r+"</li>")})},a.on("update.fs",function(){return f.find(".options").empty(),n()}),n()})}}).call(this);
